package com.grocery.service;

import com.grocery.model.ProductItem;
import com.grocery.repository.ProductItemRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

@Service
public class ProductItemService {

    @Autowired
    private ProductItemRepository productItemRepository;

    @Autowired
    private ProductService productService;

    @Transactional
    public ProductItem saveProductItem(ProductItem productItem) {
        return productItemRepository.save(productItem);
    }

    @Transactional
    public void deleteProductItem(Long productItemId) {
        ProductItem productItem = productItemRepository.findById(productItemId).orElse(null);
        if (productItem != null) {
            productItemRepository.delete(productItem);
            productService.deleteProductIfNoItemsLeft(productItem.getProduct().getProdId());
        }
    }
}
